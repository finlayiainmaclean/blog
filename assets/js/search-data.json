{
  
    
        "post0": {
            "title": "Assayable biological processes",
            "content": "Whilst it often useful to use GeneOntology&#39;s biological processes to approximate the pathomechanisms of a disease, one frequently finds themself whittling through a list of enriched biological processes, trying to find a process that is actually assayable. . Fortunately, living deep within the Supplementary Material of a Nature paper, lives a curated list of processes testable through specific molecular experiments. . !pip install gseapy import gseapy as gp import pandas as pd . . Collecting gseapy Downloading gseapy-0.10.5-py3-none-any.whl (525 kB) |████████████████████████████████| 525 kB 8.8 MB/s Requirement already satisfied: numpy&gt;=1.13.0 in /usr/local/lib/python3.7/dist-packages (from gseapy) (1.19.5) Collecting bioservices Downloading bioservices-1.8.1.tar.gz (199 kB) |████████████████████████████████| 199 kB 13.6 MB/s Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from gseapy) (1.1.5) Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from gseapy) (2.23.0) Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from gseapy) (1.0.1) Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from gseapy) (1.4.1) Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from gseapy) (3.2.2) Collecting grequests Downloading grequests-0.6.0-py3-none-any.whl (5.2 kB) Collecting requests_cache Downloading requests_cache-0.8.1-py3-none-any.whl (44 kB) |████████████████████████████████| 44 kB 2.1 MB/s Collecting easydev&gt;=0.9.36 Downloading easydev-0.12.0.tar.gz (47 kB) |████████████████████████████████| 47 kB 3.7 MB/s Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.7/dist-packages (from bioservices-&gt;gseapy) (4.6.3) Collecting xmltodict Downloading xmltodict-0.12.0-py2.py3-none-any.whl (9.2 kB) Requirement already satisfied: lxml in /usr/local/lib/python3.7/dist-packages (from bioservices-&gt;gseapy) (4.2.6) Collecting suds-jurko Downloading suds-jurko-0.6.zip (255 kB) |████████████████████████████████| 255 kB 42.2 MB/s Requirement already satisfied: appdirs in /usr/local/lib/python3.7/dist-packages (from bioservices-&gt;gseapy) (1.4.4) Requirement already satisfied: wrapt in /usr/local/lib/python3.7/dist-packages (from bioservices-&gt;gseapy) (1.12.1) Collecting colorlog Downloading colorlog-6.4.1-py2.py3-none-any.whl (11 kB) Collecting colorama Downloading colorama-0.4.4-py2.py3-none-any.whl (16 kB) Requirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from easydev&gt;=0.9.36-&gt;bioservices-&gt;gseapy) (4.8.0) Collecting gevent Downloading gevent-21.8.0-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (5.8 MB) |████████████████████████████████| 5.8 MB 15.8 MB/s Collecting zope.event Downloading zope.event-4.5.0-py2.py3-none-any.whl (6.8 kB) Collecting zope.interface Downloading zope.interface-5.4.0-cp37-cp37m-manylinux2010_x86_64.whl (251 kB) |████████████████████████████████| 251 kB 66.8 MB/s Requirement already satisfied: greenlet&lt;2.0,&gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from gevent-&gt;grequests-&gt;bioservices-&gt;gseapy) (1.1.2) Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from gevent-&gt;grequests-&gt;bioservices-&gt;gseapy) (57.4.0) Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;gseapy) (2.8.2) Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;gseapy) (2.4.7) Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;gseapy) (0.10.0) Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;gseapy) (1.3.2) Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from cycler&gt;=0.10-&gt;matplotlib-&gt;gseapy) (1.15.0) Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;gseapy) (2018.9) Requirement already satisfied: ptyprocess&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from pexpect-&gt;easydev&gt;=0.9.36-&gt;bioservices-&gt;gseapy) (0.7.0) Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;gseapy) (2021.5.30) Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;gseapy) (2.10) Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;gseapy) (3.0.4) Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;gseapy) (1.24.3) Collecting urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB) |████████████████████████████████| 127 kB 52.7 MB/s Requirement already satisfied: attrs&lt;22.0,&gt;=21.2 in /usr/local/lib/python3.7/dist-packages (from requests_cache-&gt;bioservices-&gt;gseapy) (21.2.0) Collecting cattrs&lt;2.0,&gt;=1.8 Downloading cattrs-1.8.0-py3-none-any.whl (24 kB) Collecting url-normalize&lt;2.0,&gt;=1.4 Downloading url_normalize-1.4.3-py2.py3-none-any.whl (6.8 kB) Building wheels for collected packages: bioservices, easydev, suds-jurko Building wheel for bioservices (setup.py) ... done Created wheel for bioservices: filename=bioservices-1.8.1-py3-none-any.whl size=229863 sha256=a6ca9cf361dd357d4ea33fbee0da273f7f405c9056a19e18ee51defc9872a7a3 Stored in directory: /root/.cache/pip/wheels/f7/54/e9/a7bf159efa0c5883ffaa9934525d90bf602d8f20290c2e4a33 Building wheel for easydev (setup.py) ... done Created wheel for easydev: filename=easydev-0.12.0-py3-none-any.whl size=64232 sha256=ac9ebb8890661238c832c612ec742ac5b1b18edcf86b244008bcec33eae6ae68 Stored in directory: /root/.cache/pip/wheels/82/ab/83/fdfc4017ea44a585b6754752cc5f63f2d0d63fcc1317e7174b Building wheel for suds-jurko (setup.py) ... done Created wheel for suds-jurko: filename=suds_jurko-0.6-py3-none-any.whl size=454313 sha256=1b23c52d9a8a8fefb96338e15bea76f969bf8aa188ec5c089d377280b18c76dd Stored in directory: /root/.cache/pip/wheels/f4/75/2a/54353e9cd47f7dd7861856a750c5f99f05da1ccf624100b7a5 Successfully built bioservices easydev suds-jurko Installing collected packages: zope.interface, zope.event, urllib3, url-normalize, gevent, colorlog, colorama, cattrs, xmltodict, suds-jurko, requests-cache, grequests, easydev, bioservices, gseapy Attempting uninstall: urllib3 Found existing installation: urllib3 1.24.3 Uninstalling urllib3-1.24.3: Successfully uninstalled urllib3-1.24.3 ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts. datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible. Successfully installed bioservices-1.8.1 cattrs-1.8.0 colorama-0.4.4 colorlog-6.4.1 easydev-0.12.0 gevent-21.8.0 grequests-0.6.0 gseapy-0.10.5 requests-cache-0.8.1 suds-jurko-0.6 url-normalize-1.4.3 urllib3-1.25.11 xmltodict-0.12.0 zope.event-4.5.0 zope.interface-5.4.0 Creating directory /root/.config/bioservices . !wget https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM9_ESM.xlsx !mv 41588_2015_BFng3259_MOESM9_ESM.xlsx processes.xlsx !wget https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM12_ESM.xlsx !mv 41588_2015_BFng3259_MOESM12_ESM.xlsx tissue_go_mapping.xlsx !wget https://raw.githubusercontent.com/finlayiainmaclean/datadump/main/EFO_0000342-associated-diseases.csv !curl -OL https://github.com/finlayiainmaclean/datadump/blob/main/genego.tab.zip?raw=true !unzip genego.tab.zip?raw=true processes = pd.read_excel(&#39;processes.xlsx&#39;, skiprows=1) . . --2021-10-07 08:35:26-- https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM9_ESM.xlsx Resolving static-content.springer.com (static-content.springer.com)... 151.101.0.95, 151.101.64.95, 151.101.128.95, ... Connecting to static-content.springer.com (static-content.springer.com)|151.101.0.95|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 37992 (37K) [application/octet-stream] Saving to: ‘41588_2015_BFng3259_MOESM9_ESM.xlsx’ 41588_2015_BFng3259 100%[===================&gt;] 37.10K --.-KB/s in 0.001s 2021-10-07 08:35:26 (34.9 MB/s) - ‘41588_2015_BFng3259_MOESM9_ESM.xlsx’ saved [37992/37992] --2021-10-07 08:35:26-- https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM12_ESM.xlsx Resolving static-content.springer.com (static-content.springer.com)... 151.101.0.95, 151.101.64.95, 151.101.128.95, ... Connecting to static-content.springer.com (static-content.springer.com)|151.101.0.95|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 140272 (137K) [application/octet-stream] Saving to: ‘41588_2015_BFng3259_MOESM12_ESM.xlsx’ 41588_2015_BFng3259 100%[===================&gt;] 136.98K --.-KB/s in 0.02s 2021-10-07 08:35:26 (8.72 MB/s) - ‘41588_2015_BFng3259_MOESM12_ESM.xlsx’ saved [140272/140272] --2021-10-07 08:35:26-- https://raw.githubusercontent.com/finlayiainmaclean/datadump/main/EFO_0000342-associated-diseases.csv Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ... Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 114800 (112K) [text/plain] Saving to: ‘EFO_0000342-associated-diseases.csv’ EFO_0000342-associa 100%[===================&gt;] 112.11K --.-KB/s in 0.01s 2021-10-07 08:35:27 (9.81 MB/s) - ‘EFO_0000342-associated-diseases.csv’ saved [114800/114800] % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 135 100 135 0 0 703 0 --:--:-- --:--:-- --:--:-- 703 100 146 100 146 0 0 153 0 --:--:-- --:--:-- --:--:-- 142k 100 3839k 100 3839k 0 0 2397k 0 0:00:01 0:00:01 --:--:-- 67.9M Archive: genego.tab.zip?raw=true inflating: genego.tab inflating: __MACOSX/._genego.tab . GO Term Name GO Term ID . 0 abscisic_acid_mediated_signaling_pathway | GO:0009738 | . 1 abscisic_acid_metabolic_process | GO:0009687 | . 2 acetyl_coa_biosynthetic_process_from_acetate | GO:0019427 | . 3 acetylcholine_transport | GO:0015870 | . 4 actin_cytoskeleton_reorganization | GO:0031532 | . ... ... | ... | . 968 xanthophyll_metabolic_process | GO:0016122 | . 969 xenobiotic_metabolic_process | GO:0006805 | . 970 xylan_catabolic_process | GO:0045493 | . 971 xylem_and_phloem_pattern_formation | GO:0010051 | . 972 zinc_ion_transport | GO:0006829 | . 973 rows × 2 columns . The paper also mapped tissues to biological processes via first using co-occurences, and then manually curating the list. . tissue_mapping = pd.read_excel(&#39;tissue_go_mapping.xlsx&#39;, skiprows=1).set_index(&#39;BRENDA Tissue ID&#39;) bto2name = dict(zip(tissue_mapping.index, tissue_mapping.Tissue)) go2bto = {} for bto, row in tissue_mapping.drop(columns=[&#39;Tissue&#39;]).iterrows(): for go in row: if go is None: break go2bto[go] = bto . . Let&#39;s run a prerank gene set enrichment analysis, using only testable biological processes. First we need to generate a geneset. . import numpy as np genego = pd.read_csv(&#39;genego.tab&#39;,sep=&#39; t&#39;) gene2go = [] go2name = {} for row in genego.dropna(subset=[&#39;Gene ontology (biological process)&#39;]).itertuples(): for _go in row[4].split(&#39;; &#39;): go = _go.split(&#39;[&#39;)[1].replace(&#39;]&#39;,&#39;&#39;) name = _go.split(&#39; [&#39;)[0] gene2go.append((row[2], f&quot;{name} ({go})&quot;)) go2name[go] = name gene2go = pd.DataFrame(gene2go,columns =[&#39;gene&#39;,&#39;go&#39;]) gene2go = gene2go.groupby(&#39;go&#39;)[&#39;gene&#39;].apply(list).to_dict() . . Let&#39;s run the prerankGSEA for chronic pancreatitis genes, defined by the overall association score in OpenTargets. . cp_targets = pd.read_csv(&#39;EFO_0000342-associated-diseases.csv&#39;) cp_targets.head(10) . . symbol overallAssociationScore geneticAssociations somaticMutations drugs pathwaysSystemsBiology textMining rnaExpression animalModels targetName . 0 PRSS1 | 0.834384 | 0.9183390021590296 | No data | No data | No data | 0.1838682865290527 | No data | 0.5693580106773287 | serine protease 1 | . 1 SPINK1 | 0.804783 | 0.8862311248507138 | No data | No data | No data | 0.23856390277427408 | No data | 0.3298784490540059 | serine peptidase inhibitor Kazal type 1 | . 2 CTRC | 0.740035 | 0.8910696416923192 | No data | No data | No data | 0.09941106709313025 | No data | 0.29290105828927904 | chymotrypsin C | . 3 CFTR | 0.696968 | 0.9074161629304885 | No data | No data | No data | 0.2678564156117781 | No data | 0.3978335055391351 | CF transmembrane conductance regulator | . 4 VDR | 0.369580 | No data | No data | 0.607930797611621 | No data | No data | No data | No data | vitamin D receptor | . 5 UTRN | 0.327407 | 0.5385593475017613 | No data | No data | No data | No data | No data | No data | utrophin | . 6 SCN4A | 0.327078 | No data | No data | 0.5380187558862847 | No data | No data | No data | No data | sodium voltage-gated channel alpha subunit 4 | . 7 NR3C1 | 0.323382 | No data | No data | 0.5319394479101685 | No data | No data | No data | No data | nuclear receptor subfamily 3 group C member 1 | . 8 CDKN2A | 0.295810 | No data | 0.4559480982087158 | No data | No data | 0.6127525799017898 | No data | No data | cyclin dependent kinase inhibitor 2A | . 9 KRAS | 0.278109 | No data | 0.4559480982087158 | No data | No data | 0.030396539880581056 | No data | No data | KRAS proto-oncogene, GTPase | . Running the enrichment, we see proteolysis and RNA polymerase II transcription are the most enriched processes. . pre_res = gp.prerank(rnk=cp_targets[[&#39;symbol&#39;,&#39;overallAssociationScore&#39;]], gene_sets=gene2go, processes=2, permutation_num=500, # reduce number to speed up testing outdir=&#39;prerank_report&#39;, format=&#39;png&#39;, seed=6) pre_res = pd.read_csv(&#39;prerank_report/gseapy.prerank.gene_sets.report.csv&#39;) pre_res.head(10) #Get GO name # pre_res[&#39;go_name&#39;] = pre_res.Term.apply(go2name.get) # #Map tissue # pre_res[&#39;bto&#39;] = pre_res.Term.apply(go2bto.get) # pre_res[&#39;tissue_name&#39;] = pre_res.bto.apply(bto2name.get) . Term es nes pval fdr geneset_size matched_size genes ledge_genes . 0 transcription initiation from RNA polymerase I... | 0.827233 | 1.444565 | 0.014085 | 0.509843 | 140 | 17 | VDR;NR3C1;CREBBP;CCN2;PGR;THRA;PPARG;E2F2;NR4A... | VDR;NR3C1;CREBBP;CCN2;PGR;THRA | . 1 proteolysis (GO:0006508) | 0.836005 | 1.472423 | 0.000000 | 0.584968 | 253 | 31 | PRSS1;CTRC;PCSK2;CPA1;CTSS;CTRB2;CTRB1;CTSB;EL... | PRSS1;CTRC;PCSK2;CPA1;CTSS;CTRB2;CTRB1;CTSB | . 2 lung development (GO:0030324) | 0.303998 | 0.524236 | 1.000000 | 0.997848 | 80 | 15 | CCN2;WNT5A;PDPN;VEGFA;NOTCH1;PDGFRA;EGFR;EP300... | CCN2;WNT5A;PDPN;VEGFA;NOTCH1 | . 3 anatomical structure morphogenesis (GO:0009653) | 0.798351 | 1.376056 | 0.030120 | 1.000000 | 131 | 18 | SMAD4;ONECUT1;PKD1;SMAD3;SRY;TH;KRT18;SMAD2;MC... | SMAD4;ONECUT1;PKD1 | . 4 activation of cysteine-type endopeptidase acti... | 0.742733 | 1.308484 | 0.034068 | 1.000000 | 89 | 21 | CDKN2A;NGFR;S100A9;NGF;EIF2AK3;NLRP1;BAD;PPARG... | CDKN2A;NGFR;S100A9;NGF;EIF2AK3;NLRP1;BAD | . 5 protein deubiquitination (GO:0016579) | 0.736472 | 1.301402 | 0.038000 | 1.000000 | 265 | 25 | CFTR;SMAD4;IL33;PTEN;TP53;BAP1;CYLD;HIF1A;MYC;... | CFTR;SMAD4 | . 6 extracellular matrix disassembly (GO:0022617) | 0.760249 | 1.310297 | 0.040161 | 1.000000 | 65 | 17 | PRSS1;CTSS;CTRB2;CTRB1;ELANE;CTSL;CTSV;CD44;LA... | PRSS1;CTSS;CTRB2;CTRB1 | . 7 glucose homeostasis (GO:0042593) | 0.695962 | 1.232535 | 0.056000 | 1.000000 | 104 | 37 | NGFR;PDX1;BHLHA15;GCK;INS;LEP;GCGR;WFS1;LEPR;C... | NGFR;PDX1;BHLHA15;GCK;INS;LEP;GCGR;WFS1;LEPR;C... | . 8 positive regulation of pri-miRNA transcription... | 0.721529 | 1.255786 | 0.084000 | 1.000000 | 41 | 21 | NR3C1;SMAD4;NGFR;TGFB1;TP53;PPARG;HIF1A;TNF;JU... | NR3C1;SMAD4;NGFR | . 9 endocrine pancreas development (GO:0031018) | 0.738487 | 1.282722 | 0.088000 | 1.000000 | 22 | 15 | HNF1B;ONECUT1;EIF2AK3;PAX4;MNX1;GIPR;INSM1;NEU... | HNF1B;ONECUT1;EIF2AK3;PAX4;MNX1;GIPR;INSM1;NEU... | . # Image(&#39;proteolysis (GO_0006508).prerank.png&#39;,width=1000, height=1000) . Let&#39;s take a look at the ES plot for proteolysis. . .",
            "url": "https://finlayiainmaclean.github.io/blog/useful_resources/2021/10/07/testable_processes.html",
            "relUrl": "/useful_resources/2021/10/07/testable_processes.html",
            "date": " • Oct 7, 2021"
        }
        
    
  
    
        ,"post1": {
            "title": "Hello World",
            "content": "Interesting papers . Clinical success rates Very in-depth study into what factors contribute to a drug being approved. . | Bidrectional genetic genes with both GoF and LoF mutations are 4x more likely the become drug targets (when one would assume they would only be 2x more likely). . | Revision of the seminal paper showing targets with genetic evidence are more likely to be approved. . | Paper using correlation-based diffusion through an PPI network, using DEGs as seeds. Diffused genes are more highly correlated with perturbed gene in respective study. . | Great chemoinformatics blog (where this blog gets it&#39;s namesake) . | Another great chemoinformatics blog. . | . Project ideas . Standardised FAERS data | Could build a model to predict odds ratio, imputing missing drug/phenotype pairs | After mapping drugs to direction (inhibit/activate) and target, one could see which protein level changes have affect on the phenotype. | .",
            "url": "https://finlayiainmaclean.github.io/blog/jupyter/2021/10/06/hello_world.html",
            "relUrl": "/jupyter/2021/10/06/hello_world.html",
            "date": " • Oct 6, 2021"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://finlayiainmaclean.github.io/blog/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://finlayiainmaclean.github.io/blog/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}