{
  
    
        "post0": {
            "title": "Assayable biological processes",
            "content": "Whilst it often useful to use GeneOntology&#39;s biological processes to approximate the pathomechanisms of a disease, one frequently finds themself whittling through a list of enriched biological processes, trying to find a process that is actually assayable. . Fortunately, living deep within the Supplementary Material of a Nature paper, lives a curated list of processes testable through specific molecular experiments. . import gseapy as gp import pandas as pd . . !wget https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM9_ESM.xlsx !mv 41588_2015_BFng3259_MOESM9_ESM.xlsx processes.xlsx !wget https://static-content.springer.com/esm/art%3A10.1038%2Fng.3259/MediaObjects/41588_2015_BFng3259_MOESM12_ESM.xlsx !mv 41588_2015_BFng3259_MOESM12_ESM.xlsx tissue_go_mapping.xlsx !wget https://raw.githubusercontent.com/finlayiainmaclean/datadump/main/EFO_0000342-associated-diseases.csv !curl -OL https://github.com/finlayiainmaclean/datadump/blob/main/genego.tab.zip?raw=true !unzip genego.tab.zip?raw=true processes = pd.read_excel(&#39;processes.xlsx&#39;, skiprows=1) . . GO Term Name GO Term ID . 0 abscisic_acid_mediated_signaling_pathway | GO:0009738 | . 1 abscisic_acid_metabolic_process | GO:0009687 | . 2 acetyl_coa_biosynthetic_process_from_acetate | GO:0019427 | . 3 acetylcholine_transport | GO:0015870 | . 4 actin_cytoskeleton_reorganization | GO:0031532 | . ... ... | ... | . 968 xanthophyll_metabolic_process | GO:0016122 | . 969 xenobiotic_metabolic_process | GO:0006805 | . 970 xylan_catabolic_process | GO:0045493 | . 971 xylem_and_phloem_pattern_formation | GO:0010051 | . 972 zinc_ion_transport | GO:0006829 | . 973 rows × 2 columns . The paper also mapped tissues to biological processes via first using co-occurences, and then manually curating the list. . tissue_mapping = pd.read_excel(&#39;tissue_go_mapping.xlsx&#39;, skiprows=1).set_index(&#39;BRENDA Tissue ID&#39;) bto2name = dict(zip(tissue_mapping.index, tissue_mapping.Tissue)) go2bto = {} for bto, row in tissue_mapping.drop(columns=[&#39;Tissue&#39;]).iterrows(): for go in row: if go is None: break go2bto[go] = bto . . Let&#39;s run a prerank gene set enrichment analysis, using only testable biological processes. First we need to generate a geneset. . import numpy as np genego = pd.read_csv(&#39;genego.tab&#39;,sep=&#39; t&#39;) gene2go = [] go2name = {} for row in genego.dropna(subset=[&#39;Gene ontology (biological process)&#39;]).itertuples(): for _go in row[4].split(&#39;; &#39;): go = _go.split(&#39;[&#39;)[1].replace(&#39;]&#39;,&#39;&#39;) name = _go.split(&#39; [&#39;)[0] gene2go.append((row[2], f&quot;{name} ({go})&quot;)) go2name[go] = name gene2go = pd.DataFrame(gene2go,columns =[&#39;gene&#39;,&#39;go&#39;]) gene2go = gene2go.groupby(&#39;go&#39;)[&#39;gene&#39;].apply(list).to_dict() . . Let&#39;s run the prerankGSEA for chronic pancreatitis genes, defined by the overall association score in OpenTargets. . cp_targets = pd.read_csv(&#39;EFO_0000342-associated-diseases.csv&#39;) cp_targets.head(5) . symbol overallAssociationScore geneticAssociations somaticMutations drugs pathwaysSystemsBiology textMining rnaExpression animalModels targetName . 0 PRSS1 | 0.834384 | 0.9183390021590296 | No data | No data | No data | 0.1838682865290527 | No data | 0.5693580106773287 | serine protease 1 | . 1 SPINK1 | 0.804783 | 0.8862311248507138 | No data | No data | No data | 0.23856390277427408 | No data | 0.3298784490540059 | serine peptidase inhibitor Kazal type 1 | . 2 CTRC | 0.740035 | 0.8910696416923192 | No data | No data | No data | 0.09941106709313025 | No data | 0.29290105828927904 | chymotrypsin C | . 3 CFTR | 0.696968 | 0.9074161629304885 | No data | No data | No data | 0.2678564156117781 | No data | 0.3978335055391351 | CF transmembrane conductance regulator | . 4 VDR | 0.369580 | No data | No data | 0.607930797611621 | No data | No data | No data | No data | vitamin D receptor | . Running the enrichment, we see proteolysis and RNA polymerase II transcription are the most enriched processes. . pre_res = gp.prerank(rnk=cp_targets[[&#39;symbol&#39;,&#39;overallAssociationScore&#39;]], gene_sets=gene2go, processes=2, permutation_num=500, # reduce number to speed up testing outdir=&#39;prerank_report&#39;, format=&#39;png&#39;, seed=6) pre_res = pd.read_csv(&#39;prerank_report/gseapy.prerank.gene_sets.report.csv&#39;) pre_res.head(10) #Get GO name # pre_res[&#39;go_name&#39;] = pre_res.Term.apply(go2name.get) # #Map tissue # pre_res[&#39;bto&#39;] = pre_res.Term.apply(go2bto.get) # pre_res[&#39;tissue_name&#39;] = pre_res.bto.apply(bto2name.get) . Term es nes pval fdr geneset_size matched_size genes ledge_genes . 0 transcription initiation from RNA polymerase I... | 0.827233 | 1.444565 | 0.014085 | 0.509843 | 140 | 17 | VDR;NR3C1;CREBBP;CCN2;PGR;THRA;PPARG;E2F2;NR4A... | VDR;NR3C1;CREBBP;CCN2;PGR;THRA | . 1 proteolysis (GO:0006508) | 0.836005 | 1.472423 | 0.000000 | 0.584968 | 253 | 31 | PRSS1;CTRC;PCSK2;CPA1;CTSS;CTRB2;CTRB1;CTSB;EL... | PRSS1;CTRC;PCSK2;CPA1;CTSS;CTRB2;CTRB1;CTSB | . 2 lung development (GO:0030324) | 0.303998 | 0.524236 | 1.000000 | 0.997848 | 80 | 15 | CCN2;WNT5A;PDPN;VEGFA;NOTCH1;PDGFRA;EGFR;EP300... | CCN2;WNT5A;PDPN;VEGFA;NOTCH1 | . 3 anatomical structure morphogenesis (GO:0009653) | 0.798351 | 1.376056 | 0.030120 | 1.000000 | 131 | 18 | SMAD4;ONECUT1;PKD1;SMAD3;SRY;TH;KRT18;SMAD2;MC... | SMAD4;ONECUT1;PKD1 | . 4 activation of cysteine-type endopeptidase acti... | 0.742733 | 1.308484 | 0.034068 | 1.000000 | 89 | 21 | CDKN2A;NGFR;S100A9;NGF;EIF2AK3;NLRP1;BAD;PPARG... | CDKN2A;NGFR;S100A9;NGF;EIF2AK3;NLRP1;BAD | . 5 protein deubiquitination (GO:0016579) | 0.736472 | 1.301402 | 0.038000 | 1.000000 | 265 | 25 | CFTR;SMAD4;IL33;PTEN;TP53;BAP1;CYLD;HIF1A;MYC;... | CFTR;SMAD4 | . 6 extracellular matrix disassembly (GO:0022617) | 0.760249 | 1.310297 | 0.040161 | 1.000000 | 65 | 17 | PRSS1;CTSS;CTRB2;CTRB1;ELANE;CTSL;CTSV;CD44;LA... | PRSS1;CTSS;CTRB2;CTRB1 | . 7 glucose homeostasis (GO:0042593) | 0.695962 | 1.232535 | 0.056000 | 1.000000 | 104 | 37 | NGFR;PDX1;BHLHA15;GCK;INS;LEP;GCGR;WFS1;LEPR;C... | NGFR;PDX1;BHLHA15;GCK;INS;LEP;GCGR;WFS1;LEPR;C... | . 8 positive regulation of pri-miRNA transcription... | 0.721529 | 1.255786 | 0.084000 | 1.000000 | 41 | 21 | NR3C1;SMAD4;NGFR;TGFB1;TP53;PPARG;HIF1A;TNF;JU... | NR3C1;SMAD4;NGFR | . 9 endocrine pancreas development (GO:0031018) | 0.738487 | 1.282722 | 0.088000 | 1.000000 | 22 | 15 | HNF1B;ONECUT1;EIF2AK3;PAX4;MNX1;GIPR;INSM1;NEU... | HNF1B;ONECUT1;EIF2AK3;PAX4;MNX1;GIPR;INSM1;NEU... | . Let&#39;s take a look at the ES plot for proteolysis. . from IPython.display import Image Image(&#39;proteolysis (GO_0006508).prerank.png&#39;,width=1000, height=1000) . .",
            "url": "https://finlayiainmaclean.github.io/blog/useful_resources/2021/10/07/testable_processes.html",
            "relUrl": "/useful_resources/2021/10/07/testable_processes.html",
            "date": " • Oct 7, 2021"
        }
        
    
  
    
        ,"post1": {
            "title": "Hello World",
            "content": "Interesting papers . Clinical success rates Very in-depth study into what factors contribute to a drug being approved. . | Bidrectional genetic genes with both GoF and LoF mutations are 4x more likely the become drug targets (when one would assume they would only be 2x more likely). . | Revision of the seminal paper showing targets with genetic evidence are more likely to be approved. . | Paper using correlation-based diffusion through an PPI network, using DEGs as seeds. Diffused genes are more highly correlated with perturbed gene in respective study. . | Great chemoinformatics blog (where this blog gets it&#39;s namesake) . | Another great chemoinformatics blog. . | . Project ideas . Standardised FAERS data | Could build a model to predict odds ratio, imputing missing drug/phenotype pairs | After mapping drugs to direction (inhibit/activate) and target, one could see which protein level changes have affect on the phenotype. | .",
            "url": "https://finlayiainmaclean.github.io/blog/jupyter/2021/10/06/hello_world.html",
            "relUrl": "/jupyter/2021/10/06/hello_world.html",
            "date": " • Oct 6, 2021"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://finlayiainmaclean.github.io/blog/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://finlayiainmaclean.github.io/blog/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}